textures:
  - name: shadowmap
    usage:
      - DEPTH_STENCIL
      - SAMPLED
    width: 1024
    height: 1024
ubos:
  - name: camera
    type: Camera
  - name: light
    type: Light
  - name: csmi
    type: CSMI
  - name: csm
    type: CSM
flows:
  - bindings:
      - ubo: csmi
        binding: 3
    stages:
      - name: shadow
        phases:
          - culling: CSM
            pass: shadow
            visibility: ${UP}
        framebuffer:
          depthStencil: shadowmap
        clears:
          - DEPTH
    loops:
      - stages:
          - viewport:
              x: 0
              y: 0
              width: 0.5
              height: 0.5
      - stages:
          - viewport:
              x: 0.5
              y: 0
              width: 0.5
              height: 0.5
      - stages:
          - viewport:
              x: 0
              y: 0.5
              width: 0.5
              height: 0.5
      - stages:
          - viewport:
              x: 0.5
              y: 0.5
              width: 0.5
              height: 0.5

  - bindings:
      - ubo: camera
        binding: 1
      - ubo: light
        binding: 2
      - ubo: csm
        binding: 3
      - texture: shadowmap
        binding: 0
    stages:
      - name: forward
        phases:
          - pass: default
            visibility: ${WORLD}
  - bindings:
      - ubo: camera
        binding: 1
    stages:
      - name: forward
        phases:
          - pass: default
            visibility: ${UI}
